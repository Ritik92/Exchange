import React, { useEffect, useRef, useState } from 'react';
import { ChartManager } from '../utils/ChartManager';
import { Card } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Clock, LineChart, Maximize2, RotateCcw } from 'lucide-react';

interface ExchangeData {
  time_period_start: string;
  time_period_end: string;
  time_open: string;
  time_close: string;
  rate_open: number;
  rate_high: number;
  rate_low: number;
  rate_close: number;
}

interface TimeframeOption {
  label: string;
  value: string;
}

const timeframes: TimeframeOption[] = [
  { label: '1h', value: '1h' },
  { label: '4h', value: '4h' },
  { label: '1D', value: '1d' },
  { label: '1W', value: '1w' },
];

export function TradeView({
  market,
  onTimeframeChange,
}: {
  market: string;
  onTimeframeChange?: (timeframe: string) => void;
}) {
  const chartRef = useRef<HTMLDivElement>(null);
  const chartManagerRef = useRef<ChartManager | null>(null);
  const [activeTimeframe, setActiveTimeframe] = useState<string>('1h');
  const [isFullscreen, setIsFullscreen] = useState(false);

  // In a real application, you would fetch this data from your API
  const fetchHistoricalData = async (timeframe: string) => {
    // Simulate API call - replace with actual API call
    return [
       
        {
            "time_period_start": "2024-11-01T02:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T02:00:00.1000000Z",
            "time_close": "2024-11-01T02:59:59.9000000Z",
            "rate_open": 166.9616059097984,
            "rate_high": 167.66121470194128,
            "rate_low": 165.1822154801584,
            "rate_close": 167.47550593177397
        },
        {
            "time_period_start": "2024-11-01T03:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T03:00:00.1000000Z",
            "time_close": "2024-11-01T03:59:50.1000000Z",
            "rate_open": 167.4750022177644,
            "rate_high": 167.84294073312682,
            "rate_low": 166.62941397023081,
            "rate_close": 166.97890139976138
        },
        {
            "time_period_start": "2024-11-01T04:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T04:00:05.7000000Z",
            "time_close": "2024-11-01T04:59:59.7000000Z",
            "rate_open": 166.9793762557196,
            "rate_high": 167.30994865715775,
            "rate_low": 166.490097384744,
            "rate_close": 167.20594014724563
        },
        {
            "time_period_start": "2024-11-01T05:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T05:00:00.0000000Z",
            "time_close": "2024-11-01T05:59:59.8000000Z",
            "rate_open": 167.20594014724563,
            "rate_high": 167.46159418120556,
            "rate_low": 166.6151256437644,
            "rate_close": 166.7886959402497
        },
        {
            "time_period_start": "2024-11-01T06:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T06:00:00.0000000Z",
            "time_close": "2024-11-01T06:59:59.9000000Z",
            "rate_open": 166.78869599299878,
            "rate_high": 166.87627932914583,
            "rate_low": 165.20027311944398,
            "rate_close": 165.32587730215872
        },
        {
            "time_period_start": "2024-11-01T07:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T07:00:00.1000000Z",
            "time_close": "2024-11-01T07:59:51.2000000Z",
            "rate_open": 165.32587730422705,
            "rate_high": 166.1546712593467,
            "rate_low": 164.90957589790463,
            "rate_close": 165.8337601119341
        },
        {
            "time_period_start": "2024-11-01T08:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T08:00:37.0000000Z",
            "time_close": "2024-11-01T08:59:59.9000000Z",
            "rate_open": 165.83845524996977,
            "rate_high": 166.40476404507842,
            "rate_low": 165.37984732950565,
            "rate_close": 165.66579822784382
        },
        {
            "time_period_start": "2024-11-01T09:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T09:00:00.1000000Z",
            "time_close": "2024-11-01T09:59:59.9000000Z",
            "rate_open": 165.6655470353914,
            "rate_high": 166.868168060963,
            "rate_low": 165.40649015762673,
            "rate_close": 166.8496232430068
        },
        {
            "time_period_start": "2024-11-01T10:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T10:00:00.1000000Z",
            "time_close": "2024-11-01T10:59:57.1000000Z",
            "rate_open": 166.8491655120722,
            "rate_high": 168.65791706171757,
            "rate_low": 166.75990668910316,
            "rate_close": 168.05418569319446
        },
        {
            "time_period_start": "2024-11-01T11:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T11:00:10.2000000Z",
            "time_close": "2024-11-01T11:59:59.9000000Z",
            "rate_open": 168.05000498206127,
            "rate_high": 168.55307803995976,
            "rate_low": 167.5179260211903,
            "rate_close": 167.75864411533996
        },
        {
            "time_period_start": "2024-11-01T12:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T12:00:00.0000000Z",
            "time_close": "2024-11-01T12:59:59.9000000Z",
            "rate_open": 167.75864411533996,
            "rate_high": 169.62919000202072,
            "rate_low": 167.6127636010627,
            "rate_close": 169.52796683612178
        },
        {
            "time_period_start": "2024-11-01T13:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T13:00:00.1000000Z",
            "time_close": "2024-11-01T13:59:59.8000000Z",
            "rate_open": 169.52805281614476,
            "rate_high": 172.8836532586188,
            "rate_low": 169.09171596718735,
            "rate_close": 172.8334174808685
        },
        {
            "time_period_start": "2024-11-01T14:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T14:00:00.0000000Z",
            "time_close": "2024-11-01T14:59:59.9000000Z",
            "rate_open": 172.826420862463,
            "rate_high": 173.96559194913223,
            "rate_low": 170.4796030537321,
            "rate_close": 171.42886926252362
        },
        {
            "time_period_start": "2024-11-01T15:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T15:00:00.0000000Z",
            "time_close": "2024-11-01T15:59:59.6000000Z",
            "rate_open": 171.42886920869586,
            "rate_high": 171.69628189236266,
            "rate_low": 163.57638830573984,
            "rate_close": 164.0562988135309
        },
        {
            "time_period_start": "2024-11-01T16:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T16:00:24.6000000Z",
            "time_close": "2024-11-01T16:59:59.9000000Z",
            "rate_open": 163.91312397520537,
            "rate_high": 167.63294115208527,
            "rate_low": 163.63661682190636,
            "rate_close": 166.28807174883607
        },
        {
            "time_period_start": "2024-11-01T17:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T17:00:00.1000000Z",
            "time_close": "2024-11-01T17:59:59.8000000Z",
            "rate_open": 166.27418990801166,
            "rate_high": 167.73729545903495,
            "rate_low": 165.89099764671872,
            "rate_close": 166.49251888672083
        },
        {
            "time_period_start": "2024-11-01T18:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T18:00:00.0000000Z",
            "time_close": "2024-11-01T18:59:59.6000000Z",
            "rate_open": 166.49315803396493,
            "rate_high": 167.05093342908702,
            "rate_low": 165.8673798845466,
            "rate_close": 166.11233455102544
        },
        {
            "time_period_start": "2024-11-01T19:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T19:00:00.1000000Z",
            "time_close": "2024-11-01T19:59:59.9000000Z",
            "rate_open": 166.1123345520095,
            "rate_high": 166.73544466827371,
            "rate_low": 165.30572917855284,
            "rate_close": 166.48772021603943
        },
        {
            "time_period_start": "2024-11-01T20:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T20:00:00.1000000Z",
            "time_close": "2024-11-01T20:59:59.6000000Z",
            "rate_open": 166.48772020986272,
            "rate_high": 167.0544512899574,
            "rate_low": 165.49900675352055,
            "rate_close": 165.59928296970676
        },
        {
            "time_period_start": "2024-11-01T21:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T21:00:00.0000000Z",
            "time_close": "2024-11-01T21:59:59.8000000Z",
            "rate_open": 165.5992829697728,
            "rate_high": 165.628901961228,
            "rate_low": 163.8466359709248,
            "rate_close": 165.16094086808693
        },
        {
            "time_period_start": "2024-11-01T22:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T22:00:00.0000000Z",
            "time_close": "2024-11-01T22:59:59.8000000Z",
            "rate_open": 165.16094086808693,
            "rate_high": 165.84586822545646,
            "rate_low": 164.63912933873084,
            "rate_close": 165.7676357866277
        },
        {
            "time_period_start": "2024-11-01T23:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-01T23:00:00.0000000Z",
            "time_close": "2024-11-01T23:59:59.9000000Z",
            "rate_open": 165.76763578602802,
            "rate_high": 166.3466805467848,
            "rate_low": 165.46744821496313,
            "rate_close": 166.03691368401562
        },
        {
            "time_period_start": "2024-11-02T00:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T00:00:00.1000000Z",
            "time_close": "2024-11-02T00:59:59.9000000Z",
            "rate_open": 166.03691368401562,
            "rate_high": 167.29920036892014,
            "rate_low": 165.95858298472749,
            "rate_close": 166.8225444612151
        },
        {
            "time_period_start": "2024-11-02T01:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T01:00:00.0000000Z",
            "time_close": "2024-11-02T01:59:59.9000000Z",
            "rate_open": 166.82278054151766,
            "rate_high": 167.6894230573704,
            "rate_low": 166.6839015985316,
            "rate_close": 167.3384142531277
        },
        {
            "time_period_start": "2024-11-02T02:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T02:00:00.1000000Z",
            "time_close": "2024-11-02T02:59:59.9000000Z",
            "rate_open": 167.3384142531277,
            "rate_high": 168.51421796851722,
            "rate_low": 167.14372775049532,
            "rate_close": 167.42983741878467
        },
        {
            "time_period_start": "2024-11-02T03:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T03:00:00.1000000Z",
            "time_close": "2024-11-02T03:59:52.7000000Z",
            "rate_open": 167.42983741860664,
            "rate_high": 167.6606359535913,
            "rate_low": 166.65662634881377,
            "rate_close": 166.9251275942069
        },
        {
            "time_period_start": "2024-11-02T04:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T04:00:08.1000000Z",
            "time_close": "2024-11-02T04:59:59.9000000Z",
            "rate_open": 166.95922995408176,
            "rate_high": 167.0618630066276,
            "rate_low": 166.22703286952563,
            "rate_close": 166.25339278270653
        },
        {
            "time_period_start": "2024-11-02T05:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T05:00:00.0000000Z",
            "time_close": "2024-11-02T05:59:59.8000000Z",
            "rate_open": 166.25339278270653,
            "rate_high": 166.94604334614604,
            "rate_low": 165.60594312647314,
            "rate_close": 166.81395785307313
        },
        {
            "time_period_start": "2024-11-02T06:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T06:00:00.0000000Z",
            "time_close": "2024-11-02T06:59:59.9000000Z",
            "rate_open": 166.81395785307313,
            "rate_high": 166.9478181055374,
            "rate_low": 166.1934522073908,
            "rate_close": 166.82793320282732
        },
        {
            "time_period_start": "2024-11-02T07:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T07:00:00.1000000Z",
            "time_close": "2024-11-02T07:59:59.9000000Z",
            "rate_open": 166.8279332027973,
            "rate_high": 167.63467810638778,
            "rate_low": 166.38608052212675,
            "rate_close": 167.5877609981467
        },
        {
            "time_period_start": "2024-11-02T08:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T08:00:00.1000000Z",
            "time_close": "2024-11-02T08:59:59.9000000Z",
            "rate_open": 167.5826082896901,
            "rate_high": 167.80954756111552,
            "rate_low": 166.43481471140825,
            "rate_close": 166.56043792353998
        },
        {
            "time_period_start": "2024-11-02T09:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T09:00:00.1000000Z",
            "time_close": "2024-11-02T09:59:59.9000000Z",
            "rate_open": 166.56210481511073,
            "rate_high": 167.06304165892075,
            "rate_low": 166.13309900483517,
            "rate_close": 166.3060821455267
        },
        {
            "time_period_start": "2024-11-02T10:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T10:00:00.1000000Z",
            "time_close": "2024-11-02T10:59:59.9000000Z",
            "rate_open": 166.3060821455267,
            "rate_high": 166.52120506252027,
            "rate_low": 165.85589422200633,
            "rate_close": 166.34440119720702
        },
        {
            "time_period_start": "2024-11-02T11:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T11:00:00.1000000Z",
            "time_close": "2024-11-02T11:59:59.9000000Z",
            "rate_open": 166.35332997456783,
            "rate_high": 166.51132502899426,
            "rate_low": 165.7988266581063,
            "rate_close": 165.9669813318247
        },
        {
            "time_period_start": "2024-11-02T12:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T12:00:00.1000000Z",
            "time_close": "2024-11-02T12:59:59.9000000Z",
            "rate_open": 165.96429855131151,
            "rate_high": 166.40145123454252,
            "rate_low": 164.75375966892037,
            "rate_close": 164.926438229601
        },
        {
            "time_period_start": "2024-11-02T13:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T13:00:00.1000000Z",
            "time_close": "2024-11-02T13:59:59.9000000Z",
            "rate_open": 164.92643823751195,
            "rate_high": 165.85350960843877,
            "rate_low": 164.0838603631542,
            "rate_close": 164.21237264207633
        },
        {
            "time_period_start": "2024-11-02T14:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T14:00:00.1000000Z",
            "time_close": "2024-11-02T14:59:59.8000000Z",
            "rate_open": 164.21252166610705,
            "rate_high": 164.64690260022545,
            "rate_low": 162.53413187840857,
            "rate_close": 163.42331802166885
        },
        {
            "time_period_start": "2024-11-02T15:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T15:00:00.0000000Z",
            "time_close": "2024-11-02T15:59:59.8000000Z",
            "rate_open": 163.42331802166885,
            "rate_high": 163.89925762228563,
            "rate_low": 162.05843415493538,
            "rate_close": 163.79175134674938
        },
        {
            "time_period_start": "2024-11-02T16:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T16:00:00.0000000Z",
            "time_close": "2024-11-02T16:59:59.7000000Z",
            "rate_open": 163.79175134674938,
            "rate_high": 165.38255285548152,
            "rate_low": 163.5370819117976,
            "rate_close": 164.7537592928314
        },
        {
            "time_period_start": "2024-11-02T17:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T17:00:00.0000000Z",
            "time_close": "2024-11-02T17:59:59.9000000Z",
            "rate_open": 164.7537592928314,
            "rate_high": 164.7997904994782,
            "rate_low": 163.5354978736481,
            "rate_close": 163.9475586702494
        },
        {
            "time_period_start": "2024-11-02T18:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T18:00:00.1000000Z",
            "time_close": "2024-11-02T18:59:59.9000000Z",
            "rate_open": 163.9475586694554,
            "rate_high": 164.24161943226406,
            "rate_low": 162.94984194425584,
            "rate_close": 163.93303499009002
        },
        {
            "time_period_start": "2024-11-02T19:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T19:00:00.0000000Z",
            "time_close": "2024-11-02T19:59:59.8000000Z",
            "rate_open": 163.93251667164142,
            "rate_high": 165.32218635357125,
            "rate_low": 163.7832777274789,
            "rate_close": 165.11768539939442
        },
        {
            "time_period_start": "2024-11-02T20:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T20:00:00.0000000Z",
            "time_close": "2024-11-02T20:59:59.9000000Z",
            "rate_open": 165.11768539939442,
            "rate_high": 166.8507087382217,
            "rate_low": 164.8917634421942,
            "rate_close": 166.636348724218
        },
        {
            "time_period_start": "2024-11-02T21:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T21:00:00.1000000Z",
            "time_close": "2024-11-02T21:59:59.8000000Z",
            "rate_open": 166.63671992009105,
            "rate_high": 166.90652766246998,
            "rate_low": 166.18399763216522,
            "rate_close": 166.34789858626738
        },
        {
            "time_period_start": "2024-11-02T22:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T22:00:00.0000000Z",
            "time_close": "2024-11-02T22:59:59.8000000Z",
            "rate_open": 166.34789864726048,
            "rate_high": 166.66128127329415,
            "rate_low": 165.64741689851047,
            "rate_close": 165.97332070520292
        },
        {
            "time_period_start": "2024-11-02T23:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-02T23:00:00.0000000Z",
            "time_close": "2024-11-02T23:59:59.9000000Z",
            "rate_open": 165.97332070520292,
            "rate_high": 166.13687188259385,
            "rate_low": 165.21535616397074,
            "rate_close": 166.1344807205931
        },
        {
            "time_period_start": "2024-11-03T00:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T00:00:00.1000000Z",
            "time_close": "2024-11-03T00:59:59.9000000Z",
            "rate_open": 166.13448071746691,
            "rate_high": 166.56418813806891,
            "rate_low": 165.1579817939753,
            "rate_close": 165.1594164159973
        },
        {
            "time_period_start": "2024-11-03T01:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T01:00:00.2000000Z",
            "time_close": "2024-11-03T01:59:52.8000000Z",
            "rate_open": 165.16759846380097,
            "rate_high": 165.42406529491646,
            "rate_low": 163.80760139223315,
            "rate_close": 163.83973919557732
        },
        {
            "time_period_start": "2024-11-03T02:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T02:00:38.6000000Z",
            "time_close": "2024-11-03T02:59:59.8000000Z",
            "rate_open": 164.0262087065173,
            "rate_high": 164.30854600198845,
            "rate_low": 160.96282446760563,
            "rate_close": 162.16924261055786
        },
        {
            "time_period_start": "2024-11-03T03:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T03:00:00.0000000Z",
            "time_close": "2024-11-03T03:59:59.8000000Z",
            "rate_open": 162.16924261055786,
            "rate_high": 162.49109717022793,
            "rate_low": 160.78073752238632,
            "rate_close": 161.90586654706254
        },
        {
            "time_period_start": "2024-11-03T04:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T04:00:00.0000000Z",
            "time_close": "2024-11-03T04:59:59.9000000Z",
            "rate_open": 161.90586654706254,
            "rate_high": 163.5807106439731,
            "rate_low": 161.76578120116744,
            "rate_close": 163.02875696035662
        },
        {
            "time_period_start": "2024-11-03T05:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T05:00:00.1000000Z",
            "time_close": "2024-11-03T05:59:59.9000000Z",
            "rate_open": 163.02875696154675,
            "rate_high": 163.36732564888027,
            "rate_low": 161.92504739504577,
            "rate_close": 161.948856764155
        },
        {
            "time_period_start": "2024-11-03T06:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T06:00:00.1000000Z",
            "time_close": "2024-11-03T06:59:59.9000000Z",
            "rate_open": 161.948856764155,
            "rate_high": 163.54438809363347,
            "rate_low": 161.73502635284126,
            "rate_close": 163.1220318078392
        },
        {
            "time_period_start": "2024-11-03T07:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T07:00:00.1000000Z",
            "time_close": "2024-11-03T07:59:59.9000000Z",
            "rate_open": 163.1220318078392,
            "rate_high": 164.02189472530455,
            "rate_low": 162.9143939455943,
            "rate_close": 163.47226300480685
        },
        {
            "time_period_start": "2024-11-03T08:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T08:00:00.1000000Z",
            "time_close": "2024-11-03T08:59:59.9000000Z",
            "rate_open": 163.46550987067866,
            "rate_high": 163.97022458178847,
            "rate_low": 163.0441424689504,
            "rate_close": 163.7381127865757
        },
        {
            "time_period_start": "2024-11-03T09:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T09:00:00.1000000Z",
            "time_close": "2024-11-03T09:59:59.8000000Z",
            "rate_open": 163.7312079326249,
            "rate_high": 164.038154537714,
            "rate_low": 162.5845646517289,
            "rate_close": 162.79864156761917
        },
        {
            "time_period_start": "2024-11-03T10:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T10:00:00.0000000Z",
            "time_close": "2024-11-03T10:59:59.8000000Z",
            "rate_open": 162.7798100632719,
            "rate_high": 164.4865030479341,
            "rate_low": 162.76615698708997,
            "rate_close": 164.08577151933463
        },
        {
            "time_period_start": "2024-11-03T11:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T11:00:00.0000000Z",
            "time_close": "2024-11-03T11:59:59.9000000Z",
            "rate_open": 164.08577151933463,
            "rate_high": 164.81186879348596,
            "rate_low": 163.27237688802836,
            "rate_close": 163.5891415793702
        },
        {
            "time_period_start": "2024-11-03T12:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T12:00:00.1000000Z",
            "time_close": "2024-11-03T12:59:59.7000000Z",
            "rate_open": 163.5891415793702,
            "rate_high": 164.5555744994385,
            "rate_low": 163.11031192673616,
            "rate_close": 163.52570726650177
        },
        {
            "time_period_start": "2024-11-03T13:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T13:00:00.0000000Z",
            "time_close": "2024-11-03T13:59:59.7000000Z",
            "rate_open": 163.52570726635267,
            "rate_high": 163.77150409413076,
            "rate_low": 160.6467017145217,
            "rate_close": 160.9701148110084
        },
        {
            "time_period_start": "2024-11-03T14:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T14:00:00.0000000Z",
            "time_close": "2024-11-03T14:59:59.7000000Z",
            "rate_open": 160.9701148116128,
            "rate_high": 161.57732416981258,
            "rate_low": 158.7806257399072,
            "rate_close": 159.2617419260671
        },
        {
            "time_period_start": "2024-11-03T15:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T15:00:00.0000000Z",
            "time_close": "2024-11-03T15:59:59.9000000Z",
            "rate_open": 159.2617419260671,
            "rate_high": 160.2124851118734,
            "rate_low": 157.82507438189631,
            "rate_close": 159.94085524163043
        },
        {
            "time_period_start": "2024-11-03T16:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T16:00:00.0000000Z",
            "time_close": "2024-11-03T16:59:59.8000000Z",
            "rate_open": 159.94085524163043,
            "rate_high": 161.30130099076703,
            "rate_low": 159.32761699559518,
            "rate_close": 159.46110553647642
        },
        {
            "time_period_start": "2024-11-03T17:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T17:00:00.0000000Z",
            "time_close": "2024-11-03T17:59:59.8000000Z",
            "rate_open": 159.46110553647642,
            "rate_high": 161.77020539735534,
            "rate_low": 159.41448025538227,
            "rate_close": 160.97908648892613
        },
        {
            "time_period_start": "2024-11-03T18:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T18:00:00.0000000Z",
            "time_close": "2024-11-03T18:59:59.9000000Z",
            "rate_open": 160.97908648885414,
            "rate_high": 161.28073572787446,
            "rate_low": 158.00230541955838,
            "rate_close": 158.84384154656126
        },
        {
            "time_period_start": "2024-11-03T19:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T19:00:00.2000000Z",
            "time_close": "2024-11-03T19:59:59.9000000Z",
            "rate_open": 158.84384154664892,
            "rate_high": 161.19051477559603,
            "rate_low": 158.75530557665286,
            "rate_close": 160.99431228005992
        },
        {
            "time_period_start": "2024-11-03T20:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T20:00:00.2000000Z",
            "time_close": "2024-11-03T20:59:59.9000000Z",
            "rate_open": 160.99411214487023,
            "rate_high": 162.77122907672683,
            "rate_low": 160.41538028282795,
            "rate_close": 162.68592424922247
        },
        {
            "time_period_start": "2024-11-03T21:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T21:00:00.1000000Z",
            "time_close": "2024-11-03T21:59:59.9000000Z",
            "rate_open": 162.6860520756183,
            "rate_high": 163.76442265293866,
            "rate_low": 162.4116867203406,
            "rate_close": 163.12595246445096
        },
        {
            "time_period_start": "2024-11-03T22:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T22:00:00.0000000Z",
            "time_close": "2024-11-03T22:59:59.8000000Z",
            "rate_open": 163.12595246445096,
            "rate_high": 163.7100165948657,
            "rate_low": 162.27441245456504,
            "rate_close": 162.8007732491609
        },
        {
            "time_period_start": "2024-11-03T23:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-03T23:00:00.1000000Z",
            "time_close": "2024-11-03T23:59:48.5000000Z",
            "rate_open": 162.80077325683496,
            "rate_high": 163.06691888698674,
            "rate_low": 161.7677651702268,
            "rate_close": 162.45190067890755
        },
        {
            "time_period_start": "2024-11-04T00:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T00:00:04.0000000Z",
            "time_close": "2024-11-04T00:59:49.4000000Z",
            "rate_open": 162.4623275858884,
            "rate_high": 162.47535776162695,
            "rate_low": 160.4090648708278,
            "rate_close": 161.50501474551936
        },
        {
            "time_period_start": "2024-11-04T01:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T01:00:35.5000000Z",
            "time_close": "2024-11-04T01:59:53.9000000Z",
            "rate_open": 161.7938408805267,
            "rate_high": 163.55632227251047,
            "rate_low": 161.14614610528824,
            "rate_close": 162.79756600130048
        },
        {
            "time_period_start": "2024-11-04T02:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T02:00:39.8000000Z",
            "time_close": "2024-11-04T02:59:47.7000000Z",
            "rate_open": 162.74973813307415,
            "rate_high": 164.39160300603365,
            "rate_low": 162.34885736378487,
            "rate_close": 164.32818390784846
        },
        {
            "time_period_start": "2024-11-04T03:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T03:00:33.7000000Z",
            "time_close": "2024-11-04T03:59:59.8000000Z",
            "rate_open": 164.47025363621833,
            "rate_high": 164.96924909991944,
            "rate_low": 162.63057742739338,
            "rate_close": 162.723544058321
        },
        {
            "time_period_start": "2024-11-04T04:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T04:00:00.0000000Z",
            "time_close": "2024-11-04T04:59:59.8000000Z",
            "rate_open": 162.723544058321,
            "rate_high": 163.74729277552692,
            "rate_low": 162.64149671623966,
            "rate_close": 162.90042811051214
        },
        {
            "time_period_start": "2024-11-04T05:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T05:00:00.0000000Z",
            "time_close": "2024-11-04T05:59:59.9000000Z",
            "rate_open": 162.90042811051214,
            "rate_high": 163.02485711147867,
            "rate_low": 161.25896483055442,
            "rate_close": 161.39288936166827
        },
        {
            "time_period_start": "2024-11-04T06:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T06:00:00.1000000Z",
            "time_close": "2024-11-04T06:59:59.9000000Z",
            "rate_open": 161.39281920043203,
            "rate_high": 162.6498740635885,
            "rate_low": 161.33791928397426,
            "rate_close": 162.4813893802168
        },
        {
            "time_period_start": "2024-11-04T07:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T07:00:00.1000000Z",
            "time_close": "2024-11-04T07:59:59.9000000Z",
            "rate_open": 162.4813893802168,
            "rate_high": 162.65312444514043,
            "rate_low": 161.2461877039424,
            "rate_close": 161.2823308418651
        },
        {
            "time_period_start": "2024-11-04T08:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T08:00:00.1000000Z",
            "time_close": "2024-11-04T08:59:57.2000000Z",
            "rate_open": 161.28233084838138,
            "rate_high": 161.82281660844234,
            "rate_low": 159.93860257040305,
            "rate_close": 160.50685411807046
        },
        {
            "time_period_start": "2024-11-04T09:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T09:00:27.9000000Z",
            "time_close": "2024-11-04T09:59:59.8000000Z",
            "rate_open": 160.66308686467016,
            "rate_high": 161.8990159897431,
            "rate_low": 160.48623356035515,
            "rate_close": 161.72155209225787
        },
        {
            "time_period_start": "2024-11-04T10:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T10:00:00.0000000Z",
            "time_close": "2024-11-04T10:59:59.8000000Z",
            "rate_open": 161.72155210200214,
            "rate_high": 163.69213935577477,
            "rate_low": 161.45996270253178,
            "rate_close": 163.31247780840076
        },
        {
            "time_period_start": "2024-11-04T11:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T11:00:00.0000000Z",
            "time_close": "2024-11-04T11:59:59.8000000Z",
            "rate_open": 163.30572765895474,
            "rate_high": 164.7253820788868,
            "rate_low": 162.87574723406942,
            "rate_close": 163.95087619408
        },
        {
            "time_period_start": "2024-11-04T12:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T12:00:00.0000000Z",
            "time_close": "2024-11-04T12:59:59.9000000Z",
            "rate_open": 163.95087619408,
            "rate_high": 164.84116700942008,
            "rate_low": 163.44242302204503,
            "rate_close": 164.0397741899271
        },
        {
            "time_period_start": "2024-11-04T13:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T13:00:00.1000000Z",
            "time_close": "2024-11-04T13:59:59.8000000Z",
            "rate_open": 164.05104689262234,
            "rate_high": 164.87298637388702,
            "rate_low": 163.15246348224582,
            "rate_close": 163.24034157432607
        },
        {
            "time_period_start": "2024-11-04T14:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T14:00:00.0000000Z",
            "time_close": "2024-11-04T14:59:59.9000000Z",
            "rate_open": 163.24034157432607,
            "rate_high": 164.28176702660284,
            "rate_low": 161.91654354804754,
            "rate_close": 162.4140485323237
        },
        {
            "time_period_start": "2024-11-04T15:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T15:00:00.1000000Z",
            "time_close": "2024-11-04T15:59:59.9000000Z",
            "rate_open": 162.4140485340976,
            "rate_high": 163.46203444580422,
            "rate_low": 161.53446923068532,
            "rate_close": 163.0108944504375
        },
        {
            "time_period_start": "2024-11-04T16:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T16:00:00.2000000Z",
            "time_close": "2024-11-04T16:59:59.8000000Z",
            "rate_open": 162.96638548535023,
            "rate_high": 163.4136154644115,
            "rate_low": 159.77615943936152,
            "rate_close": 160.07044107660192
        },
        {
            "time_period_start": "2024-11-04T17:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T17:00:00.0000000Z",
            "time_close": "2024-11-04T17:59:59.8000000Z",
            "rate_open": 160.07044107687886,
            "rate_high": 161.5762024379309,
            "rate_low": 159.69508413785755,
            "rate_close": 160.48150908047333
        },
        {
            "time_period_start": "2024-11-04T18:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T18:00:00.1000000Z",
            "time_close": "2024-11-04T18:59:59.8000000Z",
            "rate_open": 160.48150908047333,
            "rate_high": 161.2553222023768,
            "rate_low": 159.0290006527008,
            "rate_close": 159.09790320940934
        },
        {
            "time_period_start": "2024-11-04T19:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T19:00:00.1000000Z",
            "time_close": "2024-11-04T19:59:59.8000000Z",
            "rate_open": 159.11411380873918,
            "rate_high": 160.14407786401503,
            "rate_low": 159.06167858141237,
            "rate_close": 159.49695013870732
        },
        {
            "time_period_start": "2024-11-04T20:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T20:00:00.0000000Z",
            "time_close": "2024-11-04T20:59:59.8000000Z",
            "rate_open": 159.49562860024403,
            "rate_high": 159.9170734824224,
            "rate_low": 158.0840478031457,
            "rate_close": 158.21650488503573
        },
        {
            "time_period_start": "2024-11-04T21:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T21:00:00.0000000Z",
            "time_close": "2024-11-04T21:59:59.9000000Z",
            "rate_open": 158.21650488503573,
            "rate_high": 159.0717220528427,
            "rate_low": 155.02920527789567,
            "rate_close": 155.27646143573216
        },
        {
            "time_period_start": "2024-11-04T22:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T22:00:00.1000000Z",
            "time_close": "2024-11-04T22:59:59.9000000Z",
            "rate_open": 155.26194450036127,
            "rate_high": 158.69982122266077,
            "rate_low": 154.9920179676485,
            "rate_close": 157.934082229761
        },
        {
            "time_period_start": "2024-11-04T23:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-04T23:00:00.1000000Z",
            "time_close": "2024-11-04T23:59:59.9000000Z",
            "rate_open": 157.92514852370002,
            "rate_high": 158.24094851808644,
            "rate_low": 157.05733395972868,
            "rate_close": 157.8095202764766
        },
        {
            "time_period_start": "2024-11-05T00:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T00:00:00.1000000Z",
            "time_close": "2024-11-05T00:59:59.8000000Z",
            "rate_open": 157.8095202764766,
            "rate_high": 159.03048704197184,
            "rate_low": 157.74233261028624,
            "rate_close": 158.47193052764734
        },
        {
            "time_period_start": "2024-11-05T01:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T01:00:00.0000000Z",
            "time_close": "2024-11-05T01:59:54.2000000Z",
            "rate_open": 158.47193052764734,
            "rate_high": 158.7290836055558,
            "rate_low": 156.75979113926002,
            "rate_close": 158.0780129866745
        },
        {
            "time_period_start": "2024-11-05T02:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T02:00:32.7000000Z",
            "time_close": "2024-11-05T02:59:56.4000000Z",
            "rate_open": 158.00459932455075,
            "rate_high": 159.02043817362957,
            "rate_low": 157.8762433191318,
            "rate_close": 158.1152879595892
        },
        {
            "time_period_start": "2024-11-05T03:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T03:00:00.4000000Z",
            "time_close": "2024-11-05T03:59:56.8000000Z",
            "rate_open": 158.21752270208395,
            "rate_high": 159.5914316655275,
            "rate_low": 158.12618990125242,
            "rate_close": 159.5355122292379
        },
        {
            "time_period_start": "2024-11-05T04:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T04:00:27.4000000Z",
            "time_close": "2024-11-05T04:59:59.7000000Z",
            "rate_open": 159.59893993107113,
            "rate_high": 160.25278239071642,
            "rate_low": 159.23927452760614,
            "rate_close": 159.8739779965046
        },
        {
            "time_period_start": "2024-11-05T05:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T05:00:00.0000000Z",
            "time_close": "2024-11-05T05:59:59.9000000Z",
            "rate_open": 159.87397799448942,
            "rate_high": 160.9499402439974,
            "rate_low": 159.58736229113367,
            "rate_close": 160.69736119327771
        },
        {
            "time_period_start": "2024-11-05T06:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T06:00:00.1000000Z",
            "time_close": "2024-11-05T06:59:59.8000000Z",
            "rate_open": 160.69736119327771,
            "rate_high": 160.98791013731372,
            "rate_low": 159.86652905054666,
            "rate_close": 160.86429921989554
        },
        {
            "time_period_start": "2024-11-05T07:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T07:00:00.0000000Z",
            "time_close": "2024-11-05T07:59:59.9000000Z",
            "rate_open": 160.86429921989554,
            "rate_high": 162.3114070981181,
            "rate_low": 160.62579067479825,
            "rate_close": 161.95012547564724
        },
        {
            "time_period_start": "2024-11-05T08:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T08:00:00.1000000Z",
            "time_close": "2024-11-05T08:59:59.8000000Z",
            "rate_open": 161.95012547564724,
            "rate_high": 162.48129465945345,
            "rate_low": 161.5864838569199,
            "rate_close": 162.45171017149255
        },
        {
            "time_period_start": "2024-11-05T09:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T09:00:00.0000000Z",
            "time_close": "2024-11-05T09:59:48.2000000Z",
            "rate_open": 162.45171017149255,
            "rate_high": 163.00599966669333,
            "rate_low": 161.7034781977925,
            "rate_close": 161.80712819838686
        },
        {
            "time_period_start": "2024-11-05T10:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T10:00:33.9000000Z",
            "time_close": "2024-11-05T10:59:59.9000000Z",
            "rate_open": 161.70115899351572,
            "rate_high": 161.84265917838968,
            "rate_low": 160.94623577313848,
            "rate_close": 161.6489284981236
        },
        {
            "time_period_start": "2024-11-05T11:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T11:00:00.0000000Z",
            "time_close": "2024-11-05T11:59:59.9000000Z",
            "rate_open": 161.6489284981236,
            "rate_high": 162.74759028809515,
            "rate_low": 161.5840153606975,
            "rate_close": 162.30473322624616
        },
        {
            "time_period_start": "2024-11-05T12:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T12:00:00.1000000Z",
            "time_close": "2024-11-05T12:59:59.9000000Z",
            "rate_open": 162.30473322624616,
            "rate_high": 164.09288330477023,
            "rate_low": 161.76934033392874,
            "rate_close": 163.37633092685314
        },
        {
            "time_period_start": "2024-11-05T13:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T13:00:00.1000000Z",
            "time_close": "2024-11-05T13:59:59.9000000Z",
            "rate_open": 163.3761267152175,
            "rate_high": 163.81864415782354,
            "rate_low": 162.74082936245972,
            "rate_close": 163.67925309529986
        },
        {
            "time_period_start": "2024-11-05T14:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T14:00:00.0000000Z",
            "time_close": "2024-11-05T14:59:59.9000000Z",
            "rate_open": 163.67925309523156,
            "rate_high": 167.84059623361642,
            "rate_low": 163.3322475418314,
            "rate_close": 166.8394733337424
        },
        {
            "time_period_start": "2024-11-05T15:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T15:00:00.1000000Z",
            "time_close": "2024-11-05T15:59:59.9000000Z",
            "rate_open": 166.86026413864144,
            "rate_high": 167.52089247950192,
            "rate_low": 164.68019931164713,
            "rate_close": 165.84892472886406
        },
        {
            "time_period_start": "2024-11-05T16:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T16:00:00.1000000Z",
            "time_close": "2024-11-05T16:59:51.0000000Z",
            "rate_open": 165.8922600925041,
            "rate_high": 168.83969375500283,
            "rate_low": 165.60986347132672,
            "rate_close": 168.44538063778955
        },
        {
            "time_period_start": "2024-11-05T17:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T17:00:37.0000000Z",
            "time_close": "2024-11-05T17:59:59.7000000Z",
            "rate_open": 168.63874548834107,
            "rate_high": 169.2937274412495,
            "rate_low": 166.66319408281288,
            "rate_close": 166.7219723731425
        },
        {
            "time_period_start": "2024-11-05T18:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T18:00:00.0000000Z",
            "time_close": "2024-11-05T18:59:59.9000000Z",
            "rate_open": 166.7219723776448,
            "rate_high": 167.3607420801517,
            "rate_low": 165.971748942628,
            "rate_close": 166.95759643286902
        },
        {
            "time_period_start": "2024-11-05T19:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T19:00:00.1000000Z",
            "time_close": "2024-11-05T19:59:59.8000000Z",
            "rate_open": 166.95759643286902,
            "rate_high": 167.43878381399847,
            "rate_low": 163.43579052179155,
            "rate_close": 164.09822978477087
        },
        {
            "time_period_start": "2024-11-05T20:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T20:00:00.0000000Z",
            "time_close": "2024-11-05T20:59:59.9000000Z",
            "rate_open": 164.0843957595099,
            "rate_high": 166.97213497569825,
            "rate_low": 163.3252362108564,
            "rate_close": 166.81289198323884
        },
        {
            "time_period_start": "2024-11-05T21:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T21:00:00.2000000Z",
            "time_close": "2024-11-05T21:59:59.8000000Z",
            "rate_open": 166.81289198319283,
            "rate_high": 166.9554980604999,
            "rate_low": 165.08382326498176,
            "rate_close": 165.3582537964907
        },
        {
            "time_period_start": "2024-11-05T22:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T22:00:00.0000000Z",
            "time_close": "2024-11-05T22:59:59.8000000Z",
            "rate_open": 165.3582537964907,
            "rate_high": 167.4191372634944,
            "rate_low": 164.47431525090437,
            "rate_close": 167.393914804882
        },
        {
            "time_period_start": "2024-11-05T23:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-05T23:00:00.0000000Z",
            "time_close": "2024-11-05T23:59:54.2000000Z",
            "rate_open": 167.39925521292568,
            "rate_high": 167.7157716582418,
            "rate_low": 166.3635407912602,
            "rate_close": 166.61856031205272
        },
        {
            "time_period_start": "2024-11-06T00:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T00:00:40.3000000Z",
            "time_close": "2024-11-06T00:59:59.0000000Z",
            "rate_open": 166.81258994017008,
            "rate_high": 173.11984868386327,
            "rate_low": 166.37468557283424,
            "rate_close": 172.5342000343168
        },
        {
            "time_period_start": "2024-11-06T01:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T01:00:14.4000000Z",
            "time_close": "2024-11-06T01:59:59.9000000Z",
            "rate_open": 172.86480185532832,
            "rate_high": 174.69513491016446,
            "rate_low": 171.57385803364588,
            "rate_close": 173.32317878911812
        },
        {
            "time_period_start": "2024-11-06T02:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T02:00:00.1000000Z",
            "time_close": "2024-11-06T02:59:59.9000000Z",
            "rate_open": 173.3168350817855,
            "rate_high": 180.0551645220189,
            "rate_low": 172.58001023324115,
            "rate_close": 179.6883584342312
        },
        {
            "time_period_start": "2024-11-06T03:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T03:00:00.1000000Z",
            "time_close": "2024-11-06T03:59:59.9000000Z",
            "rate_open": 179.66748405244843,
            "rate_high": 184.97895137680734,
            "rate_low": 179.21415338399188,
            "rate_close": 184.9515205622843
        },
        {
            "time_period_start": "2024-11-06T04:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T04:00:00.1000000Z",
            "time_close": "2024-11-06T04:59:55.2000000Z",
            "rate_open": 184.9515205671411,
            "rate_high": 188.37428937787425,
            "rate_low": 182.6917611988782,
            "rate_close": 185.71277105582004
        },
        {
            "time_period_start": "2024-11-06T05:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T05:00:25.9000000Z",
            "time_close": "2024-11-06T05:59:51.5000000Z",
            "rate_open": 185.34007521535025,
            "rate_high": 185.69167302779152,
            "rate_low": 183.6272986379242,
            "rate_close": 185.30398019435492
        },
        {
            "time_period_start": "2024-11-06T06:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T06:00:07.2000000Z",
            "time_close": "2024-11-06T06:59:59.9000000Z",
            "rate_open": 185.2117775799619,
            "rate_high": 188.09301538582264,
            "rate_low": 184.91348042124923,
            "rate_close": 185.20428353013895
        },
        {
            "time_period_start": "2024-11-06T07:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T07:00:00.2000000Z",
            "time_close": "2024-11-06T07:59:59.8000000Z",
            "rate_open": 185.23751615070498,
            "rate_high": 188.23097446697435,
            "rate_low": 183.09781913415438,
            "rate_close": 183.87014283530775
        },
        {
            "time_period_start": "2024-11-06T08:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T08:00:00.0000000Z",
            "time_close": "2024-11-06T08:59:59.9000000Z",
            "rate_open": 183.88709475139504,
            "rate_high": 184.56247485558424,
            "rate_low": 180.15897230861162,
            "rate_close": 183.2311513746345
        },
        {
            "time_period_start": "2024-11-06T09:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T09:00:00.1000000Z",
            "time_close": "2024-11-06T09:59:59.8000000Z",
            "rate_open": 183.22281017894454,
            "rate_high": 185.15271805281242,
            "rate_low": 183.18325808893965,
            "rate_close": 184.3888713682826
        },
        {
            "time_period_start": "2024-11-06T10:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T10:00:00.0000000Z",
            "time_close": "2024-11-06T10:59:59.7000000Z",
            "rate_open": 184.3870747801463,
            "rate_high": 185.5896216319925,
            "rate_low": 183.6968518685695,
            "rate_close": 185.22136406096737
        },
        {
            "time_period_start": "2024-11-06T11:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T11:00:00.0000000Z",
            "time_close": "2024-11-06T11:59:59.9000000Z",
            "rate_open": 185.22136406096737,
            "rate_high": 186.9164132569479,
            "rate_low": 184.71216261220985,
            "rate_close": 186.77180397193985
        },
        {
            "time_period_start": "2024-11-06T12:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T12:00:00.2000000Z",
            "time_close": "2024-11-06T12:59:59.8000000Z",
            "rate_open": 186.771803971714,
            "rate_high": 188.76914188932724,
            "rate_low": 186.17778752583507,
            "rate_close": 186.3823636112545
        },
        {
            "time_period_start": "2024-11-06T13:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T13:00:00.0000000Z",
            "time_close": "2024-11-06T13:59:59.9000000Z",
            "rate_open": 186.39466239478912,
            "rate_high": 187.61592169108724,
            "rate_low": 185.53636509525407,
            "rate_close": 187.04218336063227
        },
        {
            "time_period_start": "2024-11-06T14:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T14:00:00.1000000Z",
            "time_close": "2024-11-06T14:59:59.9000000Z",
            "rate_open": 187.03237072046133,
            "rate_high": 188.66252746381232,
            "rate_low": 184.60662361006737,
            "rate_close": 184.97667095050963
        },
        {
            "time_period_start": "2024-11-06T15:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T15:00:00.1000000Z",
            "time_close": "2024-11-06T15:59:59.8000000Z",
            "rate_open": 184.99335421636982,
            "rate_high": 187.90109490606352,
            "rate_low": 184.32602733615482,
            "rate_close": 185.6395030053296
        },
        {
            "time_period_start": "2024-11-06T16:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T16:00:00.0000000Z",
            "time_close": "2024-11-06T16:59:59.8000000Z",
            "rate_open": 185.6395030053296,
            "rate_high": 186.30461018933264,
            "rate_low": 184.82272535160538,
            "rate_close": 186.2691757720686
        },
        {
            "time_period_start": "2024-11-06T17:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T17:00:00.0000000Z",
            "time_close": "2024-11-06T17:59:59.9000000Z",
            "rate_open": 186.27354789784886,
            "rate_high": 186.85075862675197,
            "rate_low": 185.1242317850157,
            "rate_close": 185.8467627956799
        },
        {
            "time_period_start": "2024-11-06T18:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T18:00:00.2000000Z",
            "time_close": "2024-11-06T18:59:59.8000000Z",
            "rate_open": 185.84676292097203,
            "rate_high": 187.83890857696323,
            "rate_low": 185.69645964578808,
            "rate_close": 187.75952984240567
        },
        {
            "time_period_start": "2024-11-06T19:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T19:00:00.0000000Z",
            "time_close": "2024-11-06T19:59:53.4000000Z",
            "rate_open": 187.7592914507773,
            "rate_high": 188.6484650956114,
            "rate_low": 186.72532953016093,
            "rate_close": 188.59596567797254
        },
        {
            "time_period_start": "2024-11-06T20:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T20:00:04.4000000Z",
            "time_close": "2024-11-06T20:59:59.7000000Z",
            "rate_open": 188.6051095619475,
            "rate_high": 188.89098398328989,
            "rate_low": 186.6090916158824,
            "rate_close": 187.6899923773223
        },
        {
            "time_period_start": "2024-11-06T21:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T21:00:00.0000000Z",
            "time_close": "2024-11-06T21:59:59.8000000Z",
            "rate_open": 187.6899923773223,
            "rate_high": 190.23594327636047,
            "rate_low": 186.77146364907705,
            "rate_close": 189.09295052929298
        },
        {
            "time_period_start": "2024-11-06T22:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T22:00:00.1000000Z",
            "time_close": "2024-11-06T22:59:59.8000000Z",
            "rate_open": 189.09295052840983,
            "rate_high": 190.1825971086123,
            "rate_low": 188.51201854480203,
            "rate_close": 189.18731617211975
        },
        {
            "time_period_start": "2024-11-06T23:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-06T23:00:00.0000000Z",
            "time_close": "2024-11-06T23:59:50.7000000Z",
            "rate_open": 189.1873161691096,
            "rate_high": 189.32524399967366,
            "rate_low": 186.71635160989436,
            "rate_close": 186.7716695935479
        },
        {
            "time_period_start": "2024-11-07T00:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T00:00:04.9000000Z",
            "time_close": "2024-11-07T00:59:50.4000000Z",
            "rate_open": 186.76354274785965,
            "rate_high": 187.60210339644308,
            "rate_low": 186.02869849389492,
            "rate_close": 187.41721495725673
        },
        {
            "time_period_start": "2024-11-07T01:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T01:00:51.7000000Z",
            "time_close": "2024-11-07T01:59:52.1000000Z",
            "rate_open": 187.2172795403804,
            "rate_high": 191.98904614136913,
            "rate_low": 186.9361758838137,
            "rate_close": 189.5937010013512
        },
        {
            "time_period_start": "2024-11-07T02:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T02:00:38.0000000Z",
            "time_close": "2024-11-07T02:59:59.9000000Z",
            "rate_open": 189.71248667457888,
            "rate_high": 192.06926902192683,
            "rate_low": 189.66643005265942,
            "rate_close": 191.5494425313368
        },
        {
            "time_period_start": "2024-11-07T03:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T03:00:00.1000000Z",
            "time_close": "2024-11-07T03:59:59.9000000Z",
            "rate_open": 191.5494425313368,
            "rate_high": 191.5839188187347,
            "rate_low": 188.7291047044308,
            "rate_close": 189.19137347363895
        },
        {
            "time_period_start": "2024-11-07T04:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T04:00:00.1000000Z",
            "time_close": "2024-11-07T04:59:59.9000000Z",
            "rate_open": 189.21325570116352,
            "rate_high": 190.20803174414627,
            "rate_low": 188.21387325641913,
            "rate_close": 188.66294490995787
        },
        {
            "time_period_start": "2024-11-07T05:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T05:00:00.1000000Z",
            "time_close": "2024-11-07T05:59:59.7000000Z",
            "rate_open": 188.62790979328855,
            "rate_high": 189.0527244473404,
            "rate_low": 187.82918508377534,
            "rate_close": 188.9621304792051
        },
        {
            "time_period_start": "2024-11-07T06:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T06:00:00.0000000Z",
            "time_close": "2024-11-07T06:59:59.9000000Z",
            "rate_open": 188.96213047934316,
            "rate_high": 189.1154866655484,
            "rate_low": 186.0935191493228,
            "rate_close": 187.55243819402577
        },
        {
            "time_period_start": "2024-11-07T07:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T07:00:00.1000000Z",
            "time_close": "2024-11-07T07:59:59.9000000Z",
            "rate_open": 187.56541287091383,
            "rate_high": 188.5041547202134,
            "rate_low": 187.08552514165655,
            "rate_close": 188.10368526347423
        },
        {
            "time_period_start": "2024-11-07T08:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T08:00:00.1000000Z",
            "time_close": "2024-11-07T08:59:59.9000000Z",
            "rate_open": 188.09700718483995,
            "rate_high": 189.45954905444094,
            "rate_low": 187.96903309590775,
            "rate_close": 189.04756764144557
        },
        {
            "time_period_start": "2024-11-07T09:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T09:00:00.1000000Z",
            "time_close": "2024-11-07T09:59:59.9000000Z",
            "rate_open": 189.0438281680333,
            "rate_high": 189.09953855892854,
            "rate_low": 187.66551681285247,
            "rate_close": 188.49449293862256
        },
        {
            "time_period_start": "2024-11-07T10:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T10:00:00.0000000Z",
            "time_close": "2024-11-07T10:59:59.8000000Z",
            "rate_open": 188.49449293862256,
            "rate_high": 188.52062477616155,
            "rate_low": 186.6912169938362,
            "rate_close": 187.58573262161642
        },
        {
            "time_period_start": "2024-11-07T11:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T11:00:00.0000000Z",
            "time_close": "2024-11-07T11:59:59.9000000Z",
            "rate_open": 187.59496875292308,
            "rate_high": 187.97150797526368,
            "rate_low": 186.04809310660195,
            "rate_close": 186.13184784338412
        },
        {
            "time_period_start": "2024-11-07T12:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T12:00:00.0000000Z",
            "time_close": "2024-11-07T12:59:59.9000000Z",
            "rate_open": 186.13184784338412,
            "rate_high": 187.96879850397173,
            "rate_low": 186.04690880239957,
            "rate_close": 187.65504796397494
        },
        {
            "time_period_start": "2024-11-07T13:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T13:00:00.2000000Z",
            "time_close": "2024-11-07T13:59:59.9000000Z",
            "rate_open": 187.65504796397494,
            "rate_high": 188.52427968039618,
            "rate_low": 186.07500548575487,
            "rate_close": 186.19060994506077
        },
        {
            "time_period_start": "2024-11-07T14:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T14:00:00.0000000Z",
            "time_close": "2024-11-07T14:59:59.7000000Z",
            "rate_open": 186.1906099451859,
            "rate_high": 188.4708824748437,
            "rate_low": 186.095010019127,
            "rate_close": 187.8050935506625
        },
        {
            "time_period_start": "2024-11-07T15:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T15:00:00.0000000Z",
            "time_close": "2024-11-07T15:59:59.9000000Z",
            "rate_open": 187.80509355072047,
            "rate_high": 192.90002436037858,
            "rate_low": 187.49385108232582,
            "rate_close": 192.80225511068215
        },
        {
            "time_period_start": "2024-11-07T16:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T16:00:00.1000000Z",
            "time_close": "2024-11-07T16:59:59.8000000Z",
            "rate_open": 192.80281568692442,
            "rate_high": 194.62007619720464,
            "rate_low": 191.16410437340525,
            "rate_close": 194.11133360556957
        },
        {
            "time_period_start": "2024-11-07T17:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T17:00:00.0000000Z",
            "time_close": "2024-11-07T17:59:59.8000000Z",
            "rate_open": 194.11133360557193,
            "rate_high": 196.40679688636465,
            "rate_low": 193.06321437749315,
            "rate_close": 196.08870505662543
        },
        {
            "time_period_start": "2024-11-07T18:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T18:00:00.0000000Z",
            "time_close": "2024-11-07T18:59:59.9000000Z",
            "rate_open": 196.1569667483191,
            "rate_high": 198.04904094784098,
            "rate_low": 194.96031957782566,
            "rate_close": 197.02041127527838
        },
        {
            "time_period_start": "2024-11-07T19:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T19:00:00.1000000Z",
            "time_close": "2024-11-07T19:59:59.9000000Z",
            "rate_open": 197.02830590557076,
            "rate_high": 197.48514144530404,
            "rate_low": 194.59460016124703,
            "rate_close": 197.23026528377858
        },
        {
            "time_period_start": "2024-11-07T20:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T20:00:00.2000000Z",
            "time_close": "2024-11-07T20:59:59.9000000Z",
            "rate_open": 197.23056150469552,
            "rate_high": 197.9157893380579,
            "rate_low": 196.1218448060115,
            "rate_close": 197.41416427297924
        },
        {
            "time_period_start": "2024-11-07T21:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T21:00:00.2000000Z",
            "time_close": "2024-11-07T21:59:59.9000000Z",
            "rate_open": 197.41416418161506,
            "rate_high": 198.11165912083936,
            "rate_low": 196.40028464403258,
            "rate_close": 196.46225202489273
        },
        {
            "time_period_start": "2024-11-07T22:00:00.0000000Z",
            "time_period_end": "0001-01-01T00:00:00.0000000Z",
            "time_open": "2024-11-07T22:00:00.1000000Z",
            "time_close": "2024-11-07T22:46:41.4000000Z",
            "rate_open": 196.46225202489273,
            "rate_high": 197.06841673340645,
            "rate_low": 194.61110133863,
            "rate_close": 195.78609354401684
        }
    ]
  };

  const handleTimeframeChange = async (timeframe: string) => {
    setActiveTimeframe(timeframe);
    if (onTimeframeChange) {
      onTimeframeChange(timeframe);
    }
    const newData = await fetchHistoricalData(timeframe);
    initChart(newData);
  };

  const initChart = (data: ExchangeData[]) => {
    if (chartRef.current) {
      if (chartManagerRef.current) {
        chartManagerRef.current.destroy();
      }

      const transformedData = data.map(d => ({
        timestamp: new Date(d.time_period_start).getTime(),
        open: d.rate_open,
        high: d.rate_high,
        low: d.rate_low,
        close: d.rate_close,
      })).sort((a, b) => a.timestamp - b.timestamp);

      const chartManager = new ChartManager(
        chartRef.current,
        transformedData,
        {
          background: '#0E0F14',
          
          upColor: '#039E64',
        }
      );

      chartManagerRef.current = chartManager;
    }
  };

  const toggleFullscreen = () => {
    if (!document.fullscreenElement) {
      chartRef.current?.requestFullscreen();
      setIsFullscreen(true);
    } else {
      document.exitFullscreen();
      setIsFullscreen(false);
    }
  };

  const handleReset = () => {
    // Implement Reset Login
  };

  useEffect(() => {
    const init = async () => {
      const initialData = await fetchHistoricalData(activeTimeframe);
      initChart(initialData);
    };

    init();

    return () => {
      if (chartManagerRef.current) {
        chartManagerRef.current.destroy();
      }
    };
  }, [market]);

  return (
    <Card className="bg-background  p-4 rounded-lg bg-[#14151B]">
      <div className="flex items-center justify-between mb-4">
        <div className="flex items-center space-x-2">
          <LineChart className="w-5 h-5 text-muted-foreground" />
          <span className="text-sm font-medium">{market}</span>
        </div>
        <div className="flex items-center space-x-2">
          <div className="flex bg-secondary rounded-lg p-0.5">
            {timeframes.map((tf) => (
              <Button
                key={tf.value}
                variant={activeTimeframe === tf.value ? "secondary" : "ghost"}
                size="sm"
                className="px-3 py-1 text-xs"
                onClick={() => handleTimeframeChange(tf.value)}
              >
                {tf.label}
              </Button>
            ))}
          </div>
          <Button
            variant="ghost"
            size="icon"
            onClick={handleReset}
            className="text-muted-foreground"
          >
            <RotateCcw className="w-4 h-4" />
          </Button>
          <Button
            variant="ghost"
            size="icon"
            onClick={toggleFullscreen}
            className="text-muted-foreground"
          >
            <Maximize2 className="w-4 h-4" />
          </Button>
        </div>
      </div>
      <div 
        ref={chartRef} 
        className={`w-full transition-all ${isFullscreen ? 'h-screen' : 'h-[500px]'}`}
      />
    </Card>
  );
}